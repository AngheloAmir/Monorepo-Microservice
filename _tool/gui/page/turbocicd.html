<div class="h-full flex flex-col font-sans">
    <!-- Tabs Header -->
    <div class="flex border-b border-gray-800 bg-gray-950 px-6 pt-4 text-white">
        <button onclick="window.TurboCICDPage.switchTab('ci')" id="tab-ci" class="px-6 py-3 text-sm font-bold border-b-2 border-blue-500 text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-2">
            <i class="fas fa-server"></i> CI Providers
        </button>
        <button onclick="window.TurboCICDPage.switchTab('deployscript')" id="tab-deployscript" class="px-6 py-3 text-sm font-bold border-b-2 border-transparent text-gray-500 hover:text-gray-300 hover:border-gray-700 transition-colors flex items-center gap-2">
            <i class="fas fa-code-branch"></i> Deploy Script Editor
        </button>
        <button onclick="window.TurboCICDPage.switchTab('flow')" id="tab-flow" class="px-6 py-3 text-sm font-bold border-b-2 border-transparent text-gray-500 hover:text-gray-300 hover:border-gray-700 transition-colors flex items-center gap-2">
            <i class="fas fa-project-diagram"></i> Flow Editor
        </button>
    </div>

    <!-- Content Area -->
    <div class="flex-1 relative overflow-hidden bg-gray-900 text-white">
        
        <!-- Tab 1: CI Providers -->
        <div id="view-ci" class="absolute inset-0 p-4 overflow-y-auto"></div>

        <!-- Tab 2: Deploy Script Editor -->
        <div id="view-deployscript" class="hidden absolute inset-0 flex"></div>

        <!-- Tab 3: Flow Editor -->
        <div id="view-flow" class="hidden absolute inset-0 flex"></div>
    </div>
</div>

<script>
    window.TurboCICDPage = {
        init: async function() {
            if (!window.componentCache) window.componentCache = {};
            
            await this.loadComponent('view-ci', '/gui/components/TurboCI.html');
            await this.loadComponent('view-deployscript', '/gui/components/TurboDeployScript.html');
            await this.loadComponent('view-flow', '/gui/components/TurboFlow.html');
            
            // Set default tab
            this.switchTab('ci');
        },

        loadComponent: async function(id, url) {
            const el = document.getElementById(id);
            if(!el) return;
            
            if (window.componentCache[url]) {
                el.innerHTML = window.componentCache[url];
            } else {
                try {
                    const res = await fetch(url);
                    const text = await res.text();
                    window.componentCache[url] = text;
                    el.innerHTML = text;
                } catch(e) {
                    console.error("Failed to load component", url, e);
                    el.innerHTML = `<div class="p-4 text-red-500">Error loading component</div>`;
                }
            }
        },

        switchTab: function(tab) {
            const tabs = ['ci', 'deployscript', 'flow'];
            
            tabs.forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                const view = document.getElementById(`view-${t}`);
                
                if (t === tab) {
                    btn.classList.add('border-blue-500', 'text-blue-400');
                    btn.classList.remove('border-transparent', 'text-gray-500');
                    view.classList.remove('hidden');
                    
                    // Init Logic
                    if (t === 'ci' && window.TurboCI?.init) window.TurboCI.init();
                    if (t === 'deployscript' && window.TurboDeployScript?.init) window.TurboDeployScript.init();
                    if (t === 'flow' && window.TurboFlow?.init) window.TurboFlow.init();
                    
                } else {
                    btn.classList.remove('border-blue-500', 'text-blue-400');
                    btn.classList.add('border-transparent', 'text-gray-500');
                    view.classList.add('hidden');
                }
            });
        }
    };

    window.TurboCICDPage.init();
</script>
