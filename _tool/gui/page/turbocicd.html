<div class="h-full flex flex-col font-sans">
    <!-- Tabs Header -->
    <div class="flex border-b border-gray-800 bg-gray-950 px-6 pt-4 text-white">
        <button onclick="window.TurboCICDPage.switchTab('ci')" id="tab-ci" class="px-6 py-3 text-sm font-bold border-b-2 border-blue-500 text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-2">
            <i class="fas fa-server"></i> CI Providers
        </button>
        <button onclick="window.TurboCICDPage.switchTab('pipeline')" id="tab-pipeline" class="px-6 py-3 text-sm font-bold border-b-2 border-transparent text-gray-500 hover:text-gray-300 hover:border-gray-700 transition-colors flex items-center gap-2">
            <i class="fas fa-code-branch"></i> Pipeline Editor
        </button>
    </div>

    <!-- Content Area -->
    <div class="flex-1 relative overflow-hidden bg-gray-900 text-white">
        
        <!-- Tab 1: CI Providers -->
        <div id="view-ci" class="absolute inset-0 p-4 overflow-y-auto">
             <!-- Injected TurboCI.html -->
        </div>

        <!-- Tab 2: Pipeline Editor -->
        <div id="view-pipeline" class="hidden absolute inset-0 flex">
             <!-- Injected PipelineEditor.html -->
        </div>
    </div>
</div>

<script>
    window.TurboCICDPage = {
        init: async function() {
            if (!window.componentCache) window.componentCache = {};
            
            await this.loadComponent('view-ci', '/gui/components/TurboCI.html');
            await this.loadComponent('view-pipeline', '/gui/components/PipelineEditor.html');
            
            // Set default tab
            this.switchTab('ci');
        },

        loadComponent: async function(id, url) {
            const el = document.getElementById(id);
            if(!el) return;
            
            if (window.componentCache[url]) {
                el.innerHTML = window.componentCache[url];
            } else {
                try {
                    const res = await fetch(url);
                    const text = await res.text();
                    window.componentCache[url] = text;
                    el.innerHTML = text;
                } catch(e) {
                    console.error("Failed to load component", url, e);
                    el.innerHTML = `<div class="p-4 text-red-500">Error loading component</div>`;
                }
            }
        },

        switchTab: function(tab) {
            const tabCi = document.getElementById('tab-ci');
            const tabPipeline = document.getElementById('tab-pipeline');
            const viewCi = document.getElementById('view-ci');
            const viewPipeline = document.getElementById('view-pipeline');

            if (tab === 'ci') {
                 tabCi.classList.add('border-blue-500', 'text-blue-400');
                 tabCi.classList.remove('border-transparent', 'text-gray-500');
                 
                 tabPipeline.classList.remove('border-blue-500', 'text-blue-400');
                 tabPipeline.classList.add('border-transparent', 'text-gray-500');
                 
                 viewCi.classList.remove('hidden');
                 viewPipeline.classList.add('hidden');

                 // Init Logic
                 if (window.TurboCI && window.TurboCI.init) {
                     window.TurboCI.init();
                 }
            } else {
                 tabPipeline.classList.add('border-blue-500', 'text-blue-400');
                 tabPipeline.classList.remove('border-transparent', 'text-gray-500');
                 
                 tabCi.classList.remove('border-blue-500', 'text-blue-400');
                 tabCi.classList.add('border-transparent', 'text-gray-500');
                 
                 viewPipeline.classList.remove('hidden');
                 viewCi.classList.add('hidden');
                 
                 // Init Logic
                 if (window.PipelineEditor && window.PipelineEditor.init) {
                     window.PipelineEditor.init();
                 }
            }
        }
    };

    window.TurboCICDPage.init();
</script>
